name: 'Gitbook Action Build'
on:
  push:
    branches:
      - deploy
jobs:
  build:
    runs-on: self-hosted

    steps:
    - uses: actions/checkout@v2
    - uses: actions/setup-node@v3
      with:
        node-version: '12'

    - name: go manual
      run: cd manual
      
    - name: install gitbook plugins
      run: gitbook install

    - name: build html file
      run: gitbook build

    - name: move old www-data
      run: echo ${{ secrets.PASSWORD }} | sudo -S rm -rf /var/www/html/gitbook

    - name: move htmls to www-data
      run: echo ${{ secrets.PASSWORD }} | sudo -S mv _book/ /var/www/html/gitbook